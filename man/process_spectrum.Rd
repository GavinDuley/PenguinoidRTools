% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cielab.funct.R
\name{process_spectrum}
\alias{process_spectrum}
\title{Process spectrophotometer CSV files into a combined data frame}
\usage{
process_spectrum(
  folder_path,
  skip = 13,
  wavelength_col = "WL.nm.",
  transmission_col = "X.T",
  wl_min = 300,
  wl_max = 800,
  pattern = "\\\\.csv$"
)
}
\arguments{
\item{folder_path}{Character path to folder containing CSV files}

\item{skip}{Integer number of header rows to skip in each CSV file
(default 13, typical for many spectrophotometers)}

\item{wavelength_col}{Character name of the wavelength column in source files
(default "WL.nm.")}

\item{transmission_col}{Character name of the transmission column in source files
(default "X.T")}

\item{wl_min}{Numeric minimum wavelength to include (default 300)}

\item{wl_max}{Numeric maximum wavelength to include (default 800)}

\item{pattern}{Character regex pattern to match CSV files (default "\\.csv$")}
}
\value{
A data.frame with columns:
  \describe{
    \item{sample_name}{Sample identifier (from filename)}
    \item{lambda}{Wavelength in nm}
    \item{T}{Transmission as fraction (0-1)}
  }
  Data is in long format, ready for grouping and processing.
}
\description{
Reads a folder of individual CSV files from a spectrophotometer (one file
per reading) and combines them into a single wide-format data frame
suitable for use with cielab_from_spectrum().
}
\details{
This function:
\enumerate{
  \item Scans the folder for CSV files matching the pattern
  \item Reads each file, skipping header rows
  \item Filters to the specified wavelength range
  \item Converts transmission from percentage to fraction
  \item Combines all files with sample identifiers from filenames
}
}
\examples{
\dontrun{
# Process all CSV files in a folder
spectra <- process_spectrum("path/to/spectrophotometer/data")

# Process with custom settings
spectra <- process_spectrum(
  "path/to/data",
  skip = 10,
  wavelength_col = "Wavelength",
  transmission_col = "Transmittance"
)

# Then use with cielab_from_spectrum for each sample
library(dplyr)
results <- spectra \%>\%
  group_by(sample_name) \%>\%
  group_map(~ {
    spec_df <- data.frame(
      lambda = .x$lambda,
      T = .x$T,
      path_mm = 10
    )
    cielab_from_spectrum(spec_df)
  })
}

}
